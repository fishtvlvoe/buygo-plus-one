---
phase: 11-按鈕與狀態標籤遷移-4-個頁面
plan: 02
type: execute
wave: 2
depends_on: ["11-01"]
files_modified:
  - admin/partials/shipment-products.php
autonomous: true

must_haves:
  truths:
    - "shipment-products.php 所有按鈕使用 .btn classes"
    - "shipment-products.php 狀態標籤使用 .status-tag classes"
    - "所有 Vue directives (@click, v-if, :class) 保持不變"
    - "桌面版和手機版樣式都正確"
  artifacts:
    - path: "admin/partials/shipment-products.php"
      provides: "遷移後的按鈕和狀態標籤"
      contains: "btn btn-"
  key_links:
    - from: "admin/partials/shipment-products.php"
      to: "design-system/components/button.css"
      via: "CSS class"
      pattern: "btn btn-primary|btn btn-secondary"
---

<objective>
遷移 shipment-products.php 的按鈕和狀態標籤到設計系統

Purpose: 統一備貨頁面的按鈕和狀態樣式，移除 legacy buygo-btn-* classes 和 inline Tailwind
Output: 更新後的 shipment-products.php，使用設計系統 classes
</objective>

<execution_context>
@/Users/fishtv/.claude/get-shit-done/workflows/execute-plan.md
@/Users/fishtv/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@admin/partials/shipment-products.php
@design-system/components/button.css
@design-system/components/status-tag.css
@.planning/phases/11-按鈕與狀態標籤遷移-4-個頁面/11-CONTEXT.md
@.planning/phases/11-按鈕與狀態標籤遷移-4-個頁面/11-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: 遷移操作按鈕</name>
  <files>admin/partials/shipment-products.php</files>
  <action>
找到並替換以下按鈕：

1. **重新載入按鈕** (line ~104):
   - Before: `class="buygo-btn buygo-btn-primary mt-4"`
   - After: `class="btn btn-primary mt-4"`
   - 保留 `@click="loadShipments"` directive

2. **合併按鈕** (桌面版，line ~121-122):
   - Before: `class="px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white font-medium rounded-lg transition shadow-sm"`
   - After: `class="btn btn-primary"`
   - 保留 `:disabled="!canMerge"` 和 `:class` 條件

3. **合併按鈕** (手機版浮動工具列，line ~368-377):
   - Before: inline Tailwind classes
   - After: `class="btn btn-primary"` 配合 `:class` 處理 disabled 狀態

4. **轉出貨按鈕** (桌面版表格，line ~223-228):
   - Before: `class="px-3 py-1.5 bg-orange-500 hover:bg-orange-600 text-white text-sm font-medium rounded-lg transition shadow-sm whitespace-nowrap"`
   - After: `class="btn btn-primary btn-sm"`
   - 保留 `v-if` 和 `@click` directives

5. **轉出貨按鈕** (手機版卡片，line ~346-352):
   - Before: `class="w-full px-3 py-2 text-sm font-medium text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition shadow-sm"`
   - After: `class="btn btn-primary btn-block"`

6. **確認 Modal 按鈕** (line ~421-429):
   - 取消按鈕: `class="buygo-btn buygo-btn-secondary"` → `class="btn btn-secondary"`
   - 確認按鈕: `class="buygo-btn buygo-btn-accent"` → `class="btn btn-primary"`
  </action>
  <verify>
驗證按鈕遷移完成：
```bash
# 確認不再有 buygo-btn 舊 classes
grep -c "buygo-btn" admin/partials/shipment-products.php || echo "No legacy classes found"

# 確認新 classes 已添加
grep -c "btn btn-primary\|btn btn-secondary" admin/partials/shipment-products.php
```
  </verify>
  <done>所有操作按鈕已遷移到設計系統 .btn classes</done>
</task>

<task type="auto">
  <name>Task 2: 遷移狀態標籤</name>
  <files>admin/partials/shipment-products.php</files>
  <action>
找到並替換狀態標籤（狀態顯示在桌面版表格和手機版卡片中）：

1. **桌面版狀態標籤** (line ~211-219):
   現有的 `:class` 綁定使用 inline Tailwind，需要遷移到設計系統：

   Before:
   ```html
   :class="{
       'bg-yellow-100 text-yellow-800 border border-yellow-300': shipment.status === 'pending' || shipment.status === '備貨中',
       'bg-green-100 text-green-800 border border-green-300': shipment.status === 'shipped' || shipment.status === '已出貨'
   }"
   ```

   After:
   ```html
   :class="{
       'status-tag-warning': shipment.status === 'pending' || shipment.status === '備貨中',
       'status-tag-success': shipment.status === 'shipped' || shipment.status === '已出貨'
   }"
   ```

   同時將外層 `class` 改為：
   - Before: `class="inline-block px-3 py-1 text-xs font-medium rounded-full whitespace-nowrap"`
   - After: `class="status-tag"`

2. **手機版狀態標籤** (line ~328-337):
   同樣的邏輯，將 inline styles 替換為設計系統 classes。

   根據 CONTEXT.md 的顏色語義：
   - pending/備貨中 → status-tag-warning (黃色，表示處理中)
   - shipped/已出貨 → status-tag-success (綠色，表示成功)
  </action>
  <verify>
驗證狀態標籤遷移完成：
```bash
# 確認新 classes 已添加
grep -c "status-tag" admin/partials/shipment-products.php
```
  </verify>
  <done>所有狀態標籤已遷移到設計系統 .status-tag classes</done>
</task>

</tasks>

<verification>
1. 確認沒有遺漏的 legacy classes：
   ```bash
   grep -n "buygo-btn" admin/partials/shipment-products.php || echo "Clean"
   ```

2. 確認 Vue directives 完整保留：
   ```bash
   grep -c "@click" admin/partials/shipment-products.php
   grep -c "v-if" admin/partials/shipment-products.php
   grep -c ":class" admin/partials/shipment-products.php
   ```

3. 在瀏覽器測試（手動）：
   - 訪問 https://test.buygo.me/wp-admin/admin.php?page=buygo-shipment-products
   - 確認按鈕樣式正確
   - 確認狀態標籤顏色正確
   - 測試轉出貨功能正常
</verification>

<success_criteria>
- [ ] 所有 buygo-btn-* classes 已替換為 btn btn-* classes
- [ ] 狀態標籤使用 status-tag + status-tag-warning/success classes
- [ ] 所有 Vue directives (@click, v-if, :class, :disabled) 保持不變
- [ ] 轉出貨按鈕功能正常
- [ ] 合併功能正常
- [ ] 桌面版和手機版樣式都正確
</success_criteria>

<output>
After completion, create `.planning/phases/11-按鈕與狀態標籤遷移-4-個頁面/11-02-SUMMARY.md`
</output>
