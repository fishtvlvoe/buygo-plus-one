---
phase: 11-按鈕與狀態標籤遷移-4-個頁面
plan: 05
type: execute
wave: 2
depends_on: ["11-01"]
files_modified:
  - admin/partials/products.php
autonomous: true

must_haves:
  truths:
    - "products.php 所有操作按鈕使用 .btn classes"
    - "products.php 狀態標籤使用 .status-tag classes"
    - "products.php 分配按鈕保留 icon 設計（per CONTEXT.md）"
    - "View Mode 切換功能保持不變"
    - "Grid View 不遷移（Phase 10 決策）"
    - "所有 Vue directives 保持不變"
  artifacts:
    - path: "admin/partials/products.php"
      provides: "遷移後的按鈕和狀態標籤"
      contains: "btn btn-"
  key_links:
    - from: "admin/partials/products.php"
      to: "design-system/components/button.css"
      via: "CSS class"
      pattern: "btn btn-primary|btn btn-secondary|btn btn-danger"
---

<objective>
遷移 products.php 的按鈕和狀態標籤到設計系統

Purpose: 統一商品頁面的按鈕和狀態樣式，同時保留特殊設計（分配按鈕 icon）
Output: 更新後的 products.php，使用設計系統 classes
</objective>

<execution_context>
@/Users/fishtv/.claude/get-shit-done/workflows/execute-plan.md
@/Users/fishtv/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@admin/partials/products.php
@design-system/components/button.css
@design-system/components/status-tag.css
@.planning/phases/11-按鈕與狀態標籤遷移-4-個頁面/11-CONTEXT.md
@.planning/phases/11-按鈕與狀態標籤遷移-4-個頁面/11-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: 遷移批次操作按鈕</name>
  <files>admin/partials/products.php</files>
  <action>
找到並替換批次刪除按鈕（line ~66）：

**批次刪除按鈕**:
- Before: `class="px-3 py-1.5 bg-red-50 text-red-600 rounded-lg text-xs font-medium hover:bg-red-100 border border-red-200 transition"`
- After: `class="btn btn-danger btn-sm"`
- 保留 `@click="batchDelete"`
  </action>
  <verify>
```bash
grep -n "batchDelete" admin/partials/products.php | head -3
```
  </verify>
  <done>批次刪除按鈕已遷移到 btn btn-danger</done>
</task>

<task type="auto">
  <name>Task 2: 遷移桌面版表格按鈕</name>
  <files>admin/partials/products.php</files>
  <action>
找到並替換桌面版表格的操作按鈕（line ~182-186）：

1. **分配按鈕** (line ~184):
   - 根據 CONTEXT.md，分配按鈕保留 icon 設計，不使用標準 btn class
   - 只需保持現有的 icon button 樣式：`class="p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition"`
   - **注意**：CONTEXT.md 提到「三個疊加的小 icon」，但目前設計是單個 icon，保持現狀

2. **編輯按鈕** (line ~185):
   - Before: `class="p-2 text-slate-500 hover:bg-slate-50 rounded-lg transition"`
   - After: `class="btn btn-secondary btn-sm"` 或保持 icon-only 樣式
   - 由於這是 icon-only 按鈕，保持現有樣式更適合 UI 一致性

3. **刪除按鈕** (line ~186):
   - Before: `class="p-2 text-red-500 hover:bg-red-50 rounded-lg transition"`
   - 這是 icon-only 的刪除按鈕，保持現有樣式
   - 如果需要改為文字按鈕，則使用 `class="btn btn-danger btn-sm"`

**決策**：桌面版表格的 icon-only 按鈕（分配、編輯、刪除）保持現有 icon 樣式，不強制遷移為 .btn classes，因為 icon buttons 有其自身的設計語言。
  </action>
  <verify>
```bash
grep -n "navigateTo.*allocation\|navigateTo.*edit\|deleteProduct" admin/partials/products.php | head -6
```
  </verify>
  <done>桌面版表格按鈕評估完成，icon-only 按鈕保持現狀</done>
</task>

<task type="auto">
  <name>Task 3: 遷移狀態切換按鈕和標籤</name>
  <files>admin/partials/products.php</files>
  <action>
找到並處理商品狀態相關元素：

1. **桌面版狀態切換按鈕** (line ~171):
   這是一個互動式按鈕，點擊可切換商品上架/下架狀態：

   Before:
   ```html
   <button @click="toggleStatus(product)"
           :class="product.status === 'published' ? 'bg-green-100 text-green-800 border-green-200' : 'bg-slate-100 text-slate-800 border-slate-200'"
           class="px-2.5 py-1 text-xs font-semibold rounded-full border hover:opacity-80 transition cursor-pointer">
       {{ product.status === 'published' ? '已上架' : '已下架' }}
   </button>
   ```

   After（保持為按鈕，因為是互動式的）:
   ```html
   <button @click="toggleStatus(product)"
           :class="product.status === 'published' ? 'status-tag-success' : 'status-tag-neutral'"
           class="status-tag cursor-pointer hover:opacity-80 transition">
       {{ product.status === 'published' ? '已上架' : '已下架' }}
   </button>
   ```

   注意：雖然使用了 status-tag classes，但保留為 `<button>` 元素因為需要 @click 互動。

2. **手機版狀態切換按鈕** (line ~293):
   同樣的邏輯，遷移為 status-tag classes 但保持 button 元素。

3. **Grid View 狀態標籤** (line ~219-222, ~361-364):
   根據 Phase 10 決策，Grid View 不遷移，保持現狀。
  </action>
  <verify>
```bash
grep -n "toggleStatus" admin/partials/products.php | head -5
grep -c "status-tag" admin/partials/products.php
```
  </verify>
  <done>狀態切換按鈕已遷移為 status-tag 樣式</done>
</task>

<task type="auto">
  <name>Task 4: 遷移手機版卡片按鈕</name>
  <files>admin/partials/products.php</files>
  <action>
找到並替換手機版卡片的操作按鈕（line ~329-333）：

**Mobile Table View (card-list) 操作按鈕**:

1. **分配按鈕** (line ~330):
   - Before: `class="py-3 flex items-center justify-center gap-1.5 text-blue-600 hover:bg-blue-50 bg-white transition active:bg-blue-100"`
   - After: `class="btn btn-primary flex-1"` 或保持現狀（文字按鈕）
   - 保留文字「分配」

2. **編輯按鈕** (line ~331):
   - Before: `class="py-3 flex items-center justify-center gap-1.5 text-slate-600 hover:bg-slate-50 bg-white transition active:bg-slate-100"`
   - After: `class="btn btn-secondary flex-1"`

3. **刪除按鈕** (line ~332):
   - Before: `class="py-3 flex items-center justify-center gap-1.5 text-red-500 hover:bg-red-50 bg-white transition active:bg-red-100"`
   - After: `class="btn btn-danger flex-1"`

**注意**：這些是卡片底部的 grid-cols-3 布局按鈕，需要保持 flex-1 讓它們平均分配寬度。
  </action>
  <verify>
```bash
grep -n "grid-cols-3.*divide-x" admin/partials/products.php | head -3
```
  </verify>
  <done>手機版卡片操作按鈕已遷移</done>
</task>

<task type="auto">
  <name>Task 5: 遷移子頁面按鈕</name>
  <files>admin/partials/products.php</files>
  <action>
找到並替換子頁面（編輯、分配、下單名單）的按鈕（line ~454-457）：

1. **取消/關閉按鈕**:
   - Before: `class="px-3 py-1.5 md:px-4 md:py-2 bg-white border border-slate-300 rounded-lg text-slate-700 hover:bg-slate-50 transition text-xs md:text-sm font-medium"`
   - After: `class="btn btn-secondary btn-sm md:btn"`

2. **儲存/確認按鈕**:
   - Before: `class="px-3 py-1.5 md:px-6 md:py-2 bg-primary text-white rounded-lg hover:bg-blue-700 transition text-xs md:text-sm font-medium shadow-lg shadow-blue-200"`
   - After: `class="btn btn-primary btn-sm md:btn"`
  </action>
  <verify>
```bash
grep -n "currentView !== 'list'" -A 20 admin/partials/products.php | grep -n "button"
```
  </verify>
  <done>子頁面按鈕已遷移</done>
</task>

</tasks>

<verification>
1. 確認 View Mode 切換功能保持不變：
   ```bash
   grep -n "viewMode" admin/partials/products.php | head -5
   ```

2. 確認 Grid View 未被修改（Phase 10 決策）：
   - Desktop Grid View (line ~195-268)
   - Mobile Grid View (line ~337-407)
   應該保持原狀。

3. 確認 Vue directives 完整保留：
   ```bash
   grep -c "@click" admin/partials/products.php
   grep -c "v-if\|v-show" admin/partials/products.php
   ```

4. 在瀏覽器測試（手動）：
   - 訪問商品頁面
   - 確認 Table View 按鈕樣式正確
   - 確認狀態切換功能正常
   - 確認編輯/分配/刪除功能正常
   - 確認 Grid View 未受影響
</verification>

<success_criteria>
- [ ] 批次刪除按鈕使用 btn btn-danger classes
- [ ] 狀態切換按鈕使用 status-tag classes（保持 button 元素）
- [ ] 手機版卡片操作按鈕使用 btn classes
- [ ] 子頁面按鈕使用 btn classes
- [ ] 桌面版表格 icon-only 按鈕保持現狀
- [ ] Grid View 未被修改
- [ ] 所有 Vue directives 保持不變
- [ ] 桌面版和手機版樣式都正確
</success_criteria>

<output>
After completion, create `.planning/phases/11-按鈕與狀態標籤遷移-4-個頁面/11-05-SUMMARY.md`
</output>
