# Plan 23-03: Portal UI 社群連結按鈕

```yaml
wave: 2
depends_on: [23-01, 23-02]
files_modified:
  - components/shared/new-sidebar.php
  - includes/views/assets/design-system.css
autonomous: true
```

## Goal

在 BuyGo Portal 側邊欄新增「前往社群」icon 按鈕，讓賣家和小幫手快速進入 FluentCommunity。

## Context

- 位置：側邊欄底部（收合按鈕上方）
- 設計：只有 icon，不含文字
- 連結：FluentCommunity 社群頁面（待確認 URL）
- 權限：無限制（所有登入的賣家/小幫手都能看到）
- 使用自定義 SVG 圖示（社群/群組 icon）

## Tasks

### Task 1: 在 sidebar 新增社群按鈕

修改 `components/shared/new-sidebar.php`，在收合按鈕上方新增社群連結：

```xml
<edit file="components/shared/new-sidebar.php">
<find>
        <!-- 收合按鈕 -->
        <button @click="isSidebarCollapsed = !isSidebarCollapsed"
            class="hidden lg:flex p-4 border-t border-slate-100 text-slate-400 hover:text-slate-600 justify-center transition-colors">
</find>
<insert_before>
        <!-- 社群連結按鈕 -->
        <a href="<?php echo esc_url(home_url('/community')); ?>"
           target="_blank"
           class="flex items-center justify-center p-4 border-t border-slate-100 text-slate-400 hover:text-primary hover:bg-blue-50 transition-colors group"
           title="前往 BuyGo 社群">
            <svg class="w-6 h-6 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
            </svg>
            <span class="ml-3 font-medium whitespace-nowrap transition-opacity duration-200 hidden lg:block text-sm"
                  :class="isSidebarCollapsed ? 'opacity-0 w-0 overflow-hidden' : 'opacity-100'">
                前往社群
            </span>
        </a>

</insert_before>
</edit>
```

**Expected:** 側邊欄底部包含社群連結按鈕，位於收合按鈕上方。

### Task 2: 在手機版選單新增社群按鈕

修改 `components/shared/new-sidebar.php`，在手機版選單也加入社群連結：

```xml
<edit file="components/shared/new-sidebar.php">
<find>
            <!-- 選單 -->
            <nav class="flex-1 overflow-y-auto py-4 space-y-1">
                <a v-for="item in menuItems" :key="item.id"
</find>
<find>
                </a>
            </nav>
</find>
<insert_after>

            <!-- 社群連結 -->
            <div class="border-t border-slate-100 p-4">
                <a href="<?php echo esc_url(home_url('/community')); ?>"
                   target="_blank"
                   class="flex items-center px-6 py-3 text-slate-600 hover:bg-blue-50 hover:text-primary rounded-lg transition-colors">
                    <svg class="w-6 h-6 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                    </svg>
                    <span class="ml-3 font-medium">前往社群</span>
                </a>
            </div>
</insert_after>
</edit>
```

**Expected:** 手機版選單底部包含社群連結按鈕。

### Task 3: 測試社群按鈕

```xml
<bash>
# 檢查 sidebar 是否包含社群按鈕
grep -n "前往社群" components/shared/new-sidebar.php

echo "手動測試步驟："
echo "1. 造訪 https://test.buygo.me/buygo-portal/dashboard"
echo "2. 檢查桌面版側邊欄底部是否顯示社群 icon"
echo "3. 點擊社群 icon，確認在新分頁開啟社群頁面"
echo "4. 切換到手機版視圖，檢查選單底部是否有社群連結"
echo "5. 測試 sidebar 收合時，社群 icon 仍然顯示"
</bash>
```

**手動驗證步驟:**
1. 造訪 https://test.buygo.me/buygo-portal/dashboard
2. 桌面版：檢查側邊欄底部（收合按鈕上方）是否顯示社群 icon
3. 點擊社群 icon，確認在新分頁開啟 FluentCommunity
4. 測試 sidebar 收合狀態下，社群 icon 正常顯示
5. 手機版：開啟選單，檢查底部是否有「前往社群」連結

## Verification Criteria

- [ ] 桌面版側邊欄底部顯示社群 icon 按鈕
- [ ] 社群按鈕使用正確的 SVG 圖示（群組/社群 icon）
- [ ] 點擊後在新分頁開啟社群頁面（target="_blank"）
- [ ] hover 效果正確（藍色背景 + 主題色 icon）
- [ ] sidebar 收合時，icon 仍然顯示
- [ ] sidebar 展開時，顯示「前往社群」文字
- [ ] 手機版選單底部包含社群連結
- [ ] 無權限限制（所有登入用戶都能看到）

## Must-Haves (Goal-Backward)

為了「讓賣家和小幫手快速進入 FluentCommunity」，必須：
1. ✓ 社群按鈕位於顯眼位置（側邊欄底部）
2. ✓ 點擊後在新分頁開啟社群頁面
3. ✓ 使用清楚的 icon 和 hover 效果
4. ✓ 桌面版和手機版都有社群連結

## Notes

- FluentCommunity URL：`/community`（相對路徑，使用 `home_url('/community')`）
- 使用 Heroicons 的 "users" icon（群組/社群圖示）
- hover 效果與選單項目一致（藍色背景 + 主題色）
- target="_blank" 確保在新分頁開啟
- title 屬性提供 tooltip 說明

---

*Plan: 23-03*
*Created: 2026-01-31*
