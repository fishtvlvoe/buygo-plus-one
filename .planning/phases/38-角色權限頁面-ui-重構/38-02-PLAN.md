---
phase: 38-角色權限頁面-ui-重構
plan: 02
type: execute
wave: 2
depends_on: [38-01]
files_modified:
  - includes/admin/class-settings-page.php
  - admin/js/admin-settings.js
  - admin/css/admin-settings.css
autonomous: true

must_haves:
  truths:
    - "賣家類型欄位在列表中完全消失"
    - "發送綁定連結按鈕在操作欄位中完全消失"
    - "buygo_seller_type user meta 仍保留在資料庫中（不刪除）"
  artifacts:
    - path: "includes/admin/class-settings-page.php"
      provides: "移除賣家類型欄位和發送綁定按鈕"
    - path: "admin/js/admin-settings.js"
      provides: "移除相關 JavaScript 事件處理器"
    - path: "admin/css/admin-settings.css"
      provides: "移除相關 CSS 樣式"
  key_links:
    - from: "render_roles_tab()"
      to: "table HTML"
      via: "PHP conditional rendering"
      pattern: "seller-type|send-binding"
---

<objective>
欄位隱藏與移除：移除賣家類型欄位和發送綁定按鈕，簡化 UI

Purpose: 簡化角色權限頁面，移除不再使用的功能（賣家類型、發送綁定）
Output: 更簡潔的角色權限列表，只保留必要欄位
</objective>

<execution_context>
@/Users/fishtv/.claude/get-shit-done/workflows/execute-plan.md
@/Users/fishtv/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@/Users/fishtv/Development/buygo-plus-one-dev/.planning/STATE.md
@/Users/fishtv/Development/buygo-plus-one-dev/.planning/ROADMAP.md
@/Users/fishtv/Development/buygo-plus-one-dev/.planning/REQUIREMENTS.md
@/Users/fishtv/Development/buygo-plus-one-dev/includes/admin/class-settings-page.php (lines 654-935)
@/Users/fishtv/Development/buygo-plus-one-dev/admin/js/admin-settings.js
@/Users/fishtv/Development/buygo-plus-one-dev/admin/css/admin-settings.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: 移除賣家類型欄位和發送綁定按鈕（PHP）</name>
  <files>includes/admin/class-settings-page.php</files>
  <action>
在 `render_roles_tab()` 方法中進行以下修改：

1. **移除表頭中的「賣家類型」欄位**（約 line 804）：

找到：
```html
<th>賣家類型</th>
```
刪除這一行。

2. **移除表格內容中的賣家類型下拉選單**（約 line 834-839）：

找到並刪除整個 `<td>` 區塊：
```php
<td>
    <select class="seller-type-select" data-user-id="<?php echo esc_attr($user['id']); ?>" style="font-size: 12px;">
        <option value="test" <?php selected($user['seller_type'], 'test'); ?>>測試賣家</option>
        <option value="real" <?php selected($user['seller_type'], 'real'); ?>>真實賣家</option>
    </select>
</td>
```

3. **移除操作欄位中的「發送綁定連結」按鈕**（約 line 859-862）：

找到並刪除這整個 `<?php if ... endif; ?>` 區塊：
```php
<?php if (!$user['is_bound']): ?>
    <button type="button" class="button button-secondary send-binding-link" data-user-id="<?php echo esc_attr($user['id']); ?>" style="font-size: 12px; padding: 6px 12px; height: auto; line-height: 1.4;">
        發送綁定連結
    </button>
<?php endif; ?>
```

**重要**：不要移除 PHP 程式碼中讀取 `seller_type` 的邏輯（約 line 718-722），因為 `buygo_seller_type` user meta 仍需保留在系統中，只是不顯示。
  </action>
  <verify>
```bash
cd /Users/fishtv/Development/buygo-plus-one-dev && php -l includes/admin/class-settings-page.php
```
  </verify>
  <done>表格中「賣家類型」欄位和「發送綁定連結」按鈕完全消失</done>
</task>

<task type="auto">
  <name>Task 2: 清理 JavaScript 中的相關程式碼</name>
  <files>admin/js/admin-settings.js</files>
  <action>
1. **移除賣家類型切換邏輯**（line 237-299）：

找到並刪除整個區塊：
```javascript
// 賣家類型切換
$('.seller-type-select').on('change', function() {
    const select = $(this);
    const userId = select.data('user-id');
    const sellerType = select.val();
    // ... 整個 change 事件處理器直到第 299 行的 });
});
```

2. **移除發送綁定連結的事件處理器**（line 148-188）：

找到並刪除整個區塊：
```javascript
// 發送綁定連結
$(document).on('click', '.send-binding-link', function() {
    const userId = $(this).data('user-id');
    const button = $(this);
    // ... 整個 click 事件處理器直到第 188 行的 });
});
```

**保留**：商品限制數量變更的程式碼（line 301-343），因為 UI-05 需要它。
  </action>
  <verify>
```bash
cd /Users/fishtv/Development/buygo-plus-one-dev && grep -c "seller-type-select" admin/js/admin-settings.js
# 應該返回 0

cd /Users/fishtv/Development/buygo-plus-one-dev && grep -c "send-binding-link" admin/js/admin-settings.js
# 應該返回 0
```
  </verify>
  <done>JavaScript 中不再有賣家類型切換和發送綁定的程式碼</done>
</task>

<task type="auto">
  <name>Task 3: 清理 CSS 中的相關樣式</name>
  <files>admin/css/admin-settings.css</files>
  <action>
**移除發送綁定連結的樣式**（line 78-92）：

找到並刪除以下 CSS 區塊：
```css
.wp-list-table .button.send-binding-link {
    background: #2271b1 !important;
    color: white !important;
    border-color: #2271b1 !important;
    font-weight: 500;
    transition: all 0.2s ease;
}

.wp-list-table .button.send-binding-link:hover {
    background: #135e96 !important;
    border-color: #135e96 !important;
    color: white !important;
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(34, 113, 177, 0.3);
}
```

**保留**：`.remove-role` 按鈕的樣式，因為還需要使用。
  </action>
  <verify>
```bash
cd /Users/fishtv/Development/buygo-plus-one-dev && grep -c "send-binding-link" admin/css/admin-settings.css
# 應該返回 0
```
  </verify>
  <done>CSS 中不再有發送綁定按鈕的樣式</done>
</task>

</tasks>

<verification>
1. PHP 語法檢查通過
2. 表格中沒有「賣家類型」欄位（表頭和內容都移除）
3. 操作欄位沒有「發送綁定連結」按鈕
4. JavaScript 中沒有 `.seller-type-select` 和 `.send-binding-link` 相關程式碼
5. CSS 中沒有 `.send-binding-link` 樣式
6. `buygo_seller_type` user meta 仍保留在資料庫中（不刪除）
</verification>

<success_criteria>
- UI-03 完成：賣家類型欄位完全隱藏（但 user meta 保留）
- UI-04 完成：發送綁定按鈕移除
</success_criteria>

<output>
After completion, create `.planning/phases/38-角色權限頁面-ui-重構/38-02-SUMMARY.md`
</output>
